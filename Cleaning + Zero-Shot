import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd
import numpy as np
import torch
import html
import re
from transformers import pipeline
from tqdm import tqdm

user_dataframe = input("Please give the desired name of your dataframe: ")
user_csv = input("Please give the precise name of the CSV you're attempting to analyze: ")
user_tweet = input("Please give the name of the column containing your tweets: ")

def import_dataset(name_of_dataframe, name_of_dataset):
    name_of_dataframe = pd.read_csv(name_of_dataset, delimiter=',',encoding='utf-8', header = 0)
    name_of_dataframe.rename(columns={user_tweet:'tweet'})
    print(name_of_dataframe.head())

def data_processing(name_of_dataframe, name_of_tweets_column):
    name_of_dataframe[name_of_tweets_column] = name_of_dataframe[name_of_tweets_column].str.lower() #Make everything lower case
    name_of_dataframe.drop_duplicates(subset='tweet', keep='first', inplace=True, ignore_index=False) #Remove duplicates
    name_of_dataframe[~name_of_dataframe.tweet.str.startswith('rt')] #Remove tweets starting with 'rt' as they're retweets
    #name_of_dataframe.rename(columns={'Unnamed: 0':'id'}, inplace = True) ~~ this line is not needed for generalized datasets as they A) probably won't have this row, and B) it's only for human purposes that it's being renamed, the program shouldn't care whether or not it's there.
    name_of_dataframe[name_of_tweets_column] = name_of_dataframe[name_of_tweets_column].apply(lambda k: html.unescape(str(k))) #Replaces odd values such as &#8221 which have no meaning

def cleaning_tweets(name_of_tweets_column):
    name_of_tweets_column = re.sub(r'@[A-Za-z0-9]+', '', name_of_tweets_column) #Removed mentions
    name_of_tweets_column = re.sub(r'#', '', name_of_tweets_column) #Removed hashtags
    name_of_tweets_column = re.sub(r'https?:\/\/\S+', '', name_of_tweets_column) #Remove the hyperlink
    name_of_tweets_column = re.sub(r'\'[\s]+', '', name_of_tweets_column) #Remove apostrophe
    name_of_tweets_column = re.sub(r'\...+', '', name_of_tweets_column) #Remove dots
    name_of_tweets_column = re.sub(r'\!', '', name_of_tweets_column) #Remove exclamation  marks
    return name_of_tweets_column 

import_dataset(user_dataframe, user_csv)
#data_processing(user_dataframe, user_tweet)
#cleaning_tweets(user_tweet)

user_dataframe['tweet'] = user_dataframe["tweet"].apply(cleaning_tweets)
